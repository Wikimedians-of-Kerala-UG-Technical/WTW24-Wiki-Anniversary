<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wiki User Details</title>
    <style>
        :root {
            /* Light theme variables */
            --bg-color: #f8f9fa;
            --text-color: #343a40;
            --card-bg: #fff;
            --card-shadow: rgba(0, 0, 0, 0.1);
            --input-border: #ced4da;
            --hover-bg: rgba(255, 81, 47, 0.1);
        }

        [data-theme="dark"] {
            /* Dark theme variables */
            --bg-color: #1a1a1a;
            --text-color: #e1e1e1;
            --card-bg: #2d2d2d;
            --card-shadow: rgba(0, 0, 0, 0.3);
            --input-border: #4a4a4a;
            --hover-bg: rgba(255, 81, 47, 0.2);
        }

        /* Update existing styles to use CSS variables */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            text-align: center;
            overflow-x: hidden; /* Prevent horizontal scrollbar */
        }

        header {
            background: linear-gradient(
                45deg,
                #FF512F 0%,
                #DD2476 50%,
                #FF8C42 100%
            );
            color: white;
            padding: 1em;
            text-align: center;
            box-shadow: 0 4px 15px var(--card-shadow);
            position: relative;
            z-index: 1;
        }
        
        .columns {
            display: flex;
            width: 100%;
        }

        .column {
            flex: 1;
            padding: 10px;
        }
        
        main {
            max-width: 600px;
            margin: 20px auto;
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px var(--card-shadow);
            animation: fadeIn 0.5s ease-in-out; /* Fade-in animation */
            position: relative;
            z-index: 1;
        }

        form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        label {
            margin-bottom: 10px;
            color: #DD2476;
        }

        input {
            padding: 10px;
            margin-bottom: 20px;
            width: 60%;
            box-sizing: border-box;
            border: 1px solid var(--input-border);
            border-radius: 5px;
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        button {
            background: linear-gradient(45deg, #FF512F, #DD2476);
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        button:hover {
            background: linear-gradient(45deg, #DD2476, #FF8C42);
            transform: translateY(-2px);
        }
        
        #wishAnniversaryButton {
            background: linear-gradient(45deg, #FF512F, #DD2476);
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease
        }

        #wishAnniversaryButton:hover {
            background: linear-gradient(45deg, #DD2476, #FF8C42);
            transform: translateY(-2px);
        }

        #userDetails {
            margin-top: 20px;
            animation: fadeIn 0.5s ease-in-out; /* Fade-in animation */
            display: flex;
            flex-wrap: wrap;
            text-align: center;
        }
        
        #userDetails h2 {
            color: #DD2476;
            text-align: center;
            margin-bottom: 10px;
        }

        #userDetails p {
            margin: 8px 0;
            
        }

        #daysToAnniversary {
            text-align: center;
            color: #007bff;
            font-weight: bold;
            margin-top: 20px;
            font-size: 20px;
            margin-bottom: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .autocomplete-container {
            position: relative;
            width: 60%;
            margin: 0 auto;
        }

        .autocomplete-list {
            position: absolute;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            background: var(--card-bg);
            border: 2px solid #DD2476;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            z-index: 1000;
            display: none;
            margin-top: 5px;
        }

        .autocomplete-item {
            padding: 15px 20px;
            cursor: pointer;
            text-align: left;
            border-bottom: 1px solid rgba(221, 36, 118, 0.2);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            color: var(--text-color);
            background: var(--card-bg);
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover {
            background: var(--hover-bg);
            transform: translateX(5px);
        }

        .autocomplete-item.selected {
            background: linear-gradient(45deg, rgba(255, 81, 47, 0.1), rgba(221, 36, 118, 0.1));
            border-left: 4px solid #DD2476;
        }

        .autocomplete-item .username {
            font-weight: 500;
            color: #DD2476;
            margin-bottom: 4px;
            font-size: 1.1em;
        }

        .autocomplete-item .details {
            font-size: 0.85em;
            color: #666;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .autocomplete-item .details span {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        /* Update scrollbar styles */
        .autocomplete-list::-webkit-scrollbar {
            width: 8px;
        }

        .autocomplete-list::-webkit-scrollbar-track {
            background: rgba(221, 36, 118, 0.1);
            border-radius: 4px;
        }

        .autocomplete-list::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #FF512F, #DD2476);
            border-radius: 4px;
        }

        .autocomplete-list::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #DD2476, #FF8C42);
        }

        /* Update the animation for items */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .autocomplete-item {
            animation: slideIn 0.3s ease forwards;
        }

        /* Add these styles */
        #languageSelector {
            background-color: white;
            border: 1px solid #DD2476;
            color: #DD2476;
            padding: 8px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        #languageSelector:hover {
            background: linear-gradient(45deg, #FF512F, #DD2476);
            color: white;
        }

        #languageSelector option {
            background-color: white;
            color: #DD2476;
        }

        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            opacity: 0.1;
            display: flex;
            align-items: center;
        }

        .background-scroll {
            display: flex;
            animation: scroll 30s linear infinite;
            gap: 100px;
            padding: 20px;
            position: absolute;
            white-space: nowrap;
            will-change: transform;
        }

        .background-scroll img {
            width: 200px;
            height: 200px;
            object-fit: contain;
            flex-shrink: 0;
        }

        @keyframes scroll {
            0% {
                transform: translateX(100vw);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        /* Create two rows of scrolling images going in opposite directions */
        .background-container::after {
            content: '';
            position: absolute;
            top: 70%;
            left: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(transparent, rgba(255,255,255,0.1));
        }

        /* Add a second row of images scrolling in the opposite direction */
        .background-scroll:nth-child(2) {
            top: 70%;
            animation: scroll-reverse 25s linear infinite;
        }

        @keyframes scroll-reverse {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100vw);
            }
        }

        /* Update the main element styles to ensure content is visible */
        main {
            max-width: 600px;
            margin: 20px auto;
            background-color: rgba(255, 255, 255, 0.95); /* Add some transparency */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.5s ease-in-out;
            position: relative;
            z-index: 1;
        }

        /* Update header styles to ensure it's visible over the background */
        header {
            background-color: rgba(0, 123, 255, 0.95); /* Add some transparency */
            position: relative;
            z-index: 1;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        /* Add these new styles */
        #recentContributions {
            margin: 20px auto;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 0 10px var(--card-shadow);
            text-align: left;
            max-width:93%;
        }

        #recentContributions h3 {
            color: #DD2476;
            text-align: center;
            margin-bottom: 20px;
        }

        .contribution-item {
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #DD2476;
            background: var(--card-bg);
            border-radius: 5px;
            transition: all 0.3s ease;
            animation: fadeIn 0.5s ease-in-out;
        }

        .contribution-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 8px var(--card-shadow);
        }

        .contribution-title {
            color: #DD2476;
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .contribution-title a {
            color: #DD2476;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .contribution-title a:hover {
            color: #FF512F;
        }

        .contribution-meta {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
            line-height: 1.4;
        }

        .contribution-size {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: normal;
            min-width: 60px;
            text-align: center;
        }

        .size-positive {
            background-color: #d4edda;
            color: #155724;
        }

        .size-negative {
            background-color: #f8d7da;
            color: #721c24;
        }

        .size-neutral {
            background-color: #e2e3e5;
            color: #383d41;
        }

        /* Update the contribution size badges for dark mode */
        [data-theme="dark"] .size-positive {
            background-color: #1e4529;
            color: #4ade80;
        }

        [data-theme="dark"] .size-negative {
            background-color: #4c1d24;
            color: #fca5a5;
        }

        [data-theme="dark"] .size-neutral {
            background-color: #374151;
            color: #9ca3af;
        }

        /* Style for theme toggle button */
        #themeToggle {
            background: none;
            border: none;
            font-size: 1.2em;
            padding: 5px 10px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        #themeToggle:hover {
            transform: scale(1.1);
        }

        /* Update the header styles */
        header {
            background: linear-gradient(
                45deg,
                #FF512F 0%,
                #DD2476 50%,
                #FF8C42 100%
            );
            color: white;
            padding: 1em;
            text-align: center;
            box-shadow: 0 4px 15px var(--card-shadow);
            position: relative;
            z-index: 1;
        }

        /* Update main styles */
        main {
            max-width: 600px;
            margin: 20px auto;
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px var(--card-shadow);
            animation: fadeIn 0.5s ease-in-out; /* Fade-in animation */
            position: relative;
            z-index: 1;
        }

        /* Update the background container opacity for dark mode */
        [data-theme="dark"] .background-container {
            opacity: 0.05;
        }

        /* Update link colors for dark mode */
        [data-theme="dark"] a {
            color: #ff8c42;
        }

        [data-theme="dark"] a:hover {
            color: #ff512f;
        }

        /* Update label color for dark mode */
        [data-theme="dark"] label {
            color: #ff8c42;
        }

        /* Update the contribution meta text color for dark mode */
        [data-theme="dark"] .contribution-meta {
            color: #888;
        }

        /* Update the autocomplete item username color for dark mode */
        [data-theme="dark"] .autocomplete-item .username {
            color: #ff8c42;
        }

        /* Update the days to anniversary color for dark mode */
        [data-theme="dark"] #daysToAnniversary {
            color: #ff8c42;
        }

        /* Update the recent contributions title color for dark mode */
        [data-theme="dark"] #recentContributions h3 {
            color: #ff8c42;
        }

        /* Update the contribution title color for dark mode */
        [data-theme="dark"] .contribution-title {
            color: #ff8c42;
        }

        /* Update the language selector for dark mode */
        [data-theme="dark"] #languageSelector {
            background-color: var(--card-bg);
            color: var(--text-color);
            border-color: #ff8c42;
        }

        [data-theme="dark"] #languageSelector:hover {
            background: #ff8c42;
            color: #1a1a1a;
        }

        [data-theme="dark"] #languageSelector option {
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        /* Update the theme toggle button styles */
        #themeToggle {
            background-color: transparent;
            border: 2px solid #fff;
            color: #fff;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #themeToggle:hover {
            transform: scale(1.1);
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Remove these overriding styles that were causing issues */
        main {
            background-color: var(--card-bg) !important;
        }

        header {
            background-color: transparent !important;
        }

        /* Add/update these styles in the <style> section */

        /* Container for the header controls */
        .header-controls {
            position: absolute;
            right: 20px;
            top: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* Update language selector styles */
        #languageSelector {
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            border: 2px solid rgba(255, 255, 255, 0.8);
            background: transparent;
            color: white;
            transition: all 0.3s ease;
        }

        #languageSelector:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        #languageSelector option {
            background-color: var(--card-bg);
            color: var(--text-color);
            padding: 8px;
        }

        /* Update theme toggle button styles */
        #themeToggle {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.8);
            color: white;
            border-radius: 50%;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
        }

        #themeToggle:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.1);
        }

    </style>
</head>
<body>

<div class="background-container">
    <div class="background-scroll">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Wikipedia-logo-v2.svg/200px-Wikipedia-logo-v2.svg.png" alt="Wiki Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Commons-logo.svg/200px-Commons-logo.svg.png" alt="Commons Logo">
    
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Wikiversity_logo_2017.svg/200px-Wikiversity_logo_2017.svg.png" alt="Wikiversity Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Wikipedia-logo-v2.svg/200px-Wikipedia-logo-v2.svg.png" alt="Wiki Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Commons-logo.svg/200px-Commons-logo.svg.png" alt="Commons Logo">
    
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Wikiversity_logo_2017.svg/200px-Wikiversity_logo_2017.svg.png" alt="Wikiversity Logo">
    </div>
    <div class="background-scroll">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Wikipedia-logo-v2.svg/200px-Wikipedia-logo-v2.svg.png" alt="Wiki Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Commons-logo.svg/200px-Commons-logo.svg.png" alt="Commons Logo">

        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Wikiversity_logo_2017.svg/200px-Wikiversity_logo_2017.svg.png" alt="Wikiversity Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Wikipedia-logo-v2.svg/200px-Wikipedia-logo-v2.svg.png" alt="Wiki Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Commons-logo.svg/200px-Commons-logo.svg.png" alt="Commons Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f3/Wikisource-logo-en.svg/200px-Wikisource-logo-en.svg.png" alt="Wikisource Logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Wikiversity_logo_2017.svg/200px-Wikiversity_logo_2017.svg.png" alt="Wikiversity Logo">
    </div>
</div>

<header>
    <div class="header-controls">
        <select id="languageSelector" onchange="changeLanguage()">
            <option value="en">English</option>
            <option value="es">Espa√±ol</option>
            <option value="fr">Fran√ßais</option>
            <option value="de">Deutsch</option>
            <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
            <option value="zh">‰∏≠Êñá</option>
            <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
        </select>
        <button id="themeToggle" onclick="toggleTheme()">
            üåô
        </button>
    </div>
    <h1 id="pageTitle">Wiki Anniversary (User)</h1>
</header>

<main>
    <div id="usernameInput" style="display: none;">
        <form id="userForm">
            <div class="autocomplete-container">
                <label for="username">Enter Username:</label>
                <input type="text" 
                       id="username" 
                       name="username" 
                       placeholder="Wiki Username" 
                       required 
                       oninput="handleInput(event)" 
                       onkeydown="handleKeyDown(event)">
                <div id="autocompleteList" class="autocomplete-list"></div>
            </div>
            <button type="button" onclick="getUserDetails()">Get User Details</button>
        </form>
    </div>
    
    <div class="header" id="usernameHeader"></div>
    <div id="userDetails" class="columns"></div>
    <div id="recentContributions" style="margin-top: 20px; width: 100%;"></div>
    <button id="wishAnniversaryButton" style="display: none;" onclick="handleWishAnniversary()">Wish Anniversary</button>
    <div id="daysToAnniversary"></div>
    
</main>

<script>
const translations = {
    en: {
        pageTitle: "Wiki Anniversary (User)",
        enterUsername: "Enter Username:",
        getUserDetails: "Get User Details",
        registrationDate: "Registration Date:",
        totalEditCount: "Total Edit Count:",
        groups: "Groups:",
        homeWiki: "Home Wiki:",
        id: "ID:",
        rights: "Rights:",
        daysToNextAnniversary: "Days to next Anniversary:",
        wishAnniversary: "Wish Anniversary",
        userNotFound: "User not found:",
        wikiUsername: "Wiki Username",
        recentContributions: "Recent Contributions"
    },
    es: {
        pageTitle: "Aniversario Wiki (Usuario)",
        enterUsername: "Ingrese nombre de usuario:",
        getUserDetails: "Obtener detalles del usuario",
        registrationDate: "Fecha de registro:",
        totalEditCount: "Total de ediciones:",
        groups: "Grupos:",
        homeWiki: "Wiki principal:",
        id: "ID:",
        rights: "Permisos:",
        daysToNextAnniversary: "D√≠as para el pr√≥ximo aniversario:",
        wishAnniversary: "Desear feliz aniversario",
        userNotFound: "Usuario no encontrado:",
        wikiUsername: "Nombre de usuario Wiki",
        recentContributions: "Contribuciones Recientes"
    },
    fr: {
        pageTitle: "Anniversaire Wiki (Utilisateur)",
        enterUsername: "Entrez le nom d'utilisateur:",
        getUserDetails: "Obtenir les d√©tails",
        registrationDate: "Date d'inscription:",
        totalEditCount: "Nombre total de modifications:",
        groups: "Groupes:",
        homeWiki: "Wiki principal:",
        id: "ID:",
        rights: "Droits:",
        daysToNextAnniversary: "Jours avant le prochain anniversaire:",
        wishAnniversary: "Souhaiter l'anniversaire",
        userNotFound: "Utilisateur non trouv√©:",
        wikiUsername: "Nom d'utilisateur Wiki",
        recentContributions: "Contributions R√©centes"
    },
    de: {
        pageTitle: "Wiki-Jubil√§um (Benutzer)",
        enterUsername: "Benutzername eingeben:",
        getUserDetails: "Benutzerdetails abrufen",
        registrationDate: "Registrierungsdatum:",
        totalEditCount: "Gesamtzahl der Bearbeitungen:",
        groups: "Gruppen:",
        homeWiki: "Haupt-Wiki:",
        id: "ID:",
        rights: "Rechte:",
        daysToNextAnniversary: "Tage bis zum n√§chsten Jubil√§um:",
        wishAnniversary: "Jubil√§um w√ºnschen",
        userNotFound: "Benutzer nicht gefunden:",
        wikiUsername: "Wiki-Benutzername",
        recentContributions: "Letzte Beitr√§ge"
    },
    hi: {
        pageTitle: "ÔøΩÔøΩÔøΩ‡§ø‡§ï‡§ø ‡§µ‡§∞‡•ç‡§∑‡§ó‡§æ‡§Ç‡§† (‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ)",
        enterUsername: "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç:",
        getUserDetails: "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç",
        registrationDate: "‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§§‡§ø‡§•‡•Ä:",
        totalEditCount: "‡§ï‡•Å‡§≤ ‡§∏‡§Ç‡§™‡§æ‡§¶‡§®:",
        groups: "‡§∏‡§Æ‡•Ç‡§π:",
        homeWiki: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§µ‡§ø‡§ï‡§ø:",
        id: "‡§Ü‡§à‡§°‡•Ä:",
        rights: "‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞:",
        daysToNextAnniversary: "‡§Ö‡§ó‡§≤‡•Ä ‡§µ‡§∞‡•ç‡§∑‡§ó‡§æ‡§Ç‡§† ‡§§‡§ï ‡§¶‡§ø‡§®:",
        wishAnniversary: "‡§µ‡§∞‡•ç‡§∑‡§ó‡§æ‡§Ç‡§† ‡§ï‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç",
        userNotFound: "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ:",
        wikiUsername: "‡§µ‡§ø‡§ï‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ",
        recentContributions: "‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§Ø‡•ã‡§ó‡§¶‡§æ‡§®"
    },
    zh: {
        pageTitle: "Áª¥Âü∫Âë®Âπ¥ÔºàÁî®Êà∑Ôºâ",
        enterUsername: "ËæìÂÖ•Áî®Êà∑ÂêçÔºö",
        getUserDetails: "Ëé∑ÂèñÁî®Êà∑ËØ¶ÊÉÖ",
        registrationDate: "Ê≥®ÂÜåÊó•ÊúüÔºö",
        totalEditCount: "ÊÄªÁºñËæëÊ¨°Êï∞Ôºö",
        groups: "Áî®Êà∑ÁªÑÔºö",
        homeWiki: "‰∏ªÁª¥Âü∫Ôºö",
        id: "IDÔºö",
        rights: "ÔøΩÔøΩÔøΩÈôêÔºö",
        daysToNextAnniversary: "Á¶ª‰∏ã‰∏™Âë®Âπ¥ËøòÊúâÔºö",
        wishAnniversary: "Á•ùË¥∫Âë®Âπ¥",
        userNotFound: "Êú™ÊâæÂà∞Áî®Êà∑Ôºö",
        wikiUsername: "Áª¥Âü∫Áî®Êà∑Âêç",
        recentContributions: "ÊúÄËøëË¥°ÁåÆ"
    },
    ml: {
        pageTitle: "‡¥µ‡¥ø‡¥ï‡µç‡¥ï‡¥ø ‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï‡¥Ç (‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡¥æ‡¥µ‡µç)",
        enterUsername: "‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡µÉ‡¥®‡¥æ‡¥Æ‡¥Ç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï:",
        getUserDetails: "‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡¥æ‡¥µ‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥®‡µá‡¥ü‡µÅ‡¥ï",
        registrationDate: "‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª ‡¥§‡µÄ‡¥Ø‡¥§‡¥ø:",
        totalEditCount: "‡¥Ü‡¥ï‡µÜ ‡¥§‡¥ø‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥≤‡µÅ‡¥ï‡µæ:",
        groups: "‡¥ó‡µç‡¥∞‡µÇ‡¥™‡µç‡¥™‡µÅ‡¥ï‡µæ:",
        homeWiki: "‡¥π‡µã‡¥Ç ‡¥µ‡¥ø‡¥ï‡µç‡¥ï‡¥ø:",
        id: "‡¥ê‡¥°‡¥ø:",
        rights: "‡¥Ö‡¥µ‡¥ï‡¥æ‡¥∂‡¥ô‡µç‡¥ô‡µæ:",
        daysToNextAnniversary: "‡¥Ö‡¥ü‡µÅ‡¥§‡µç‡¥§ ‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï‡¥§‡µç‡¥§‡¥ø‡¥≤‡µá‡¥Ø‡µç‡¥ï‡µÅ ‡¥¶‡¥ø‡¥µ‡¥∏‡¥ô‡µç‡¥ô‡µæ:",
        wishAnniversary: "‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï‡¥æ‡¥∂‡¥Ç‡¥∏‡µæ ‡¥®‡µá‡¥∞‡µÅ‡¥ï",
        userNotFound: "‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡¥æ‡¥µ‡¥ø‡¥®‡µÜ ‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤:",
        wikiUsername: "‡¥µ‡¥ø‡¥ï‡µç‡¥ï‡¥ø ‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡µÉ‡¥®‡¥æ‡¥Æ‡¥Ç",
        recentContributions: "‡¥∏‡¥Æ‡µÄ‡¥™‡¥ï‡¥æ‡¥≤ ‡¥∏‡¥Ç‡¥≠‡¥æ‡¥µ‡¥®‡¥ï‡µæ"
    }
};

// Add this function to handle language changes
function changeLanguage() {
    const lang = document.getElementById('languageSelector').value;
    const texts = translations[lang];
    
    // Update all text elements
    document.getElementById('pageTitle').textContent = texts.pageTitle;
    document.querySelector('label[for="username"]').textContent = texts.enterUsername;
    document.querySelector('#username').placeholder = texts.wikiUsername;
    document.querySelector('button[onclick="getUserDetails()"]').textContent = texts.getUserDetails;
    document.getElementById('wishAnniversaryButton').textContent = texts.wishAnniversary;
    
    // If user details are already displayed, update them
    const userDetails = document.getElementById('userDetails');
    if (userDetails.innerHTML !== '') {
        updateUserDetailsLanguage(texts);
    }
}

// Add this function to update user details when language changes
function updateUserDetailsLanguage(texts) {
    const leftColumn = document.querySelector('#userDetails .column:first-child');
    const rightColumn = document.querySelector('#userDetails .column:last-child');
    
    if (leftColumn && rightColumn) {
        const registrationDateText = leftColumn.querySelector('p:nth-child(1)');
        const editCountText = leftColumn.querySelector('p:nth-child(3)');
        const groupsText = leftColumn.querySelector('p:nth-child(5)');
        
        if (registrationDateText) registrationDateText.innerHTML = `<strong>${texts.registrationDate}</strong>`;
        if (editCountText) editCountText.innerHTML = `<strong>${texts.totalEditCount}</strong>`;
        if (groupsText) groupsText.innerHTML = `<strong>${texts.groups}</strong>`;
        
        const homeWikiText = rightColumn.querySelector('p:nth-child(1)');
        const idText = rightColumn.querySelector('p:nth-child(3)');
        const rightsText = rightColumn.querySelector('p:nth-child(5)');
        
        if (homeWikiText) homeWikiText.innerHTML = `<strong>${texts.homeWiki}</strong>`;
        if (idText) idText.innerHTML = `<strong>${texts.id}</strong>`;
        if (rightsText) rightsText.innerHTML = `<strong>${texts.rights}</strong>`;
    }
    
    const daysToAnniversaryDiv = document.getElementById('daysToAnniversary');
    if (daysToAnniversaryDiv.innerHTML !== '') {
        const days = daysToAnniversaryDiv.textContent.match(/\d+/)[0];
        daysToAnniversaryDiv.innerHTML = `<strong>${texts.daysToNextAnniversary}</strong> ${days}`;
    }
}

// Modify the displayUserDetails function to use translations
function displayUserDetails(user) {
    const lang = document.getElementById('languageSelector').value;
    const texts = translations[lang];
    // ... rest of the displayUserDetails function remains the same, 
    // just update the text strings to use texts.propertyName ...
}

    setTimeout(function () {
        document.getElementById('usernameInput').style.display = 'block';

        // Check if the URL contains the username parameter
        const urlParams = new URLSearchParams(window.location.search);
        const usernameFromURL = urlParams.get('username');

        if (usernameFromURL) {
            
            document.getElementById('username').value = usernameFromURL;

            getUserDetails();
        }
    }, 2000);

    function getUserDetails() {
        const username = document.getElementById('username').value;

        fetch(`https://www.mediawiki.org/w/api.php?action=query&format=json&list=&meta=globaluserinfo&utf8=1&formatversion=2&guiuser=${username}&guiprop=editcount|rights|merged|groups|unattached&origin=*`, {
            method: 'GET',
            mode: 'cors',
            jsonp: 'callback',
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                displayUserDetails(data.query.globaluserinfo);
                displayDaysToAnniversary(data.query.globaluserinfo.registration);
                showButtons(); // Show the additional buttons
            })
            .catch(error => {
                console.error('Error fetching user data:', error);
            });
    }

let homewikiUrl; // Declare a variable to store the home wiki URL

async function displayUserDetails(user) {
    const userDetailsDiv = document.getElementById('userDetails');
    const usernameHeader = document.getElementById('usernameHeader');
    const daysToAnniversaryDiv = document.getElementById('daysToAnniversary');

    userDetailsDiv.innerHTML = '';
    usernameHeader.innerHTML = '';
    daysToAnniversaryDiv.innerHTML = '';

    if (user.name) {
        usernameHeader.innerHTML = `<h2>${user.name}</h2>`;

        const registrationDate = new Date(user.registration);
        const formattedDate = registrationDate.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        const leftColumn = document.createElement('div');
        leftColumn.classList.add('column');
        leftColumn.innerHTML = `<p><strong>Registration Date:</strong></p>
                                <p>${formattedDate}</p>
                                <p><strong>Total Edit Count:</strong></p>
                                <p>${user.editcount}</p>`;

        if (user.groups.length > 0) {
            leftColumn.innerHTML += `<p><strong>Groups:</strong></p><p> ${user.groups.join(', ')}</p>`;
        }

        const rightColumn = document.createElement('div');
        rightColumn.classList.add('column');

        try {
            // Fetch homewiki URL asynchronously and store it in the variable
            homewikiUrl = await fetchHomewikiUrl(user.home, user.merged);
            rightColumn.innerHTML = `<p><strong>Home Wiki:</strong></p>
                        <p><a href="${homewikiUrl}" target="_blank">${user.home}</a></p>
                        <p><strong>ID:</strong></p>
                        <p>${user.id}</p>`;
        } catch (error) {
            console.error("Error fetching homewiki URL:", error);
            rightColumn.innerHTML = `<p><strong>Home Wiki:</strong></p>
                                    <p>Not available</p>
                                    <p><strong>Home Wiki ID:</strong></p>
                                    <p>${user.id}</p>`;
        }

        if (user.rights.length > 0) {
            rightColumn.innerHTML += `<p><strong>Rights:</strong></p><p> ${user.rights.join(', ')}</p>`;
        }

        userDetailsDiv.appendChild(leftColumn);
        userDetailsDiv.appendChild(rightColumn);

        // Call displayDaysToAnniversary with the user's registration date
        displayDaysToAnniversary(user.registration, daysToAnniversaryDiv);

        // Fetch and display recent contributions
        const contributions = await fetchRecentContributions(user.name);
        displayRecentContributions(contributions);
    } else {
        usernameHeader.innerHTML = `<h2 style="color: red;">User not found: ${document.getElementById('username').value}</h2>`;
        daysToAnniversaryDiv.innerHTML = '';
    }
}

// Function to fetch the homewiki URL asynchronously
async function fetchHomewikiUrl(homeWiki, mergedEntries) {
    const matchingEntry = mergedEntries.find(entry => entry.wiki === homeWiki);

    if (matchingEntry) {
        return matchingEntry.url;
    } else {
        return "Not available";
    }
}

// Function to handle the click event of the wishAnniversaryButton
function handleWishAnniversary() {
    const username = document.getElementById('username').value;

    // Construct the URL using the stored homewikiUrl variable
    const anniversaryURL = `${homewikiUrl}/w/index.php?title=User_talk:${username}&action=edit&section=new`;

    // Open the URL in a new tab
    window.open(anniversaryURL, '_blank');
}

// Add event listener to the wishAnniversaryButton
document.getElementById('wishAnniversaryButton').addEventListener('click', handleWishAnniversary);

function displayDaysToAnniversary(registrationDate, daysToAnniversaryDiv) {
    const anniversaryDate = new Date(registrationDate);
    const today = new Date();

    // Create a copy of anniversaryDate to avoid modifying it directly
    const anniversaryDateCopy = new Date(anniversaryDate);

    // Set the anniversary date to the current year
    anniversaryDateCopy.setFullYear(today.getFullYear());

    // If today is the anniversary day, set it to next year
    if (today >= anniversaryDateCopy) {
        anniversaryDateCopy.setFullYear(today.getFullYear() + 1);
    }

    // Calculate the difference in days between the current date and the anniversary date
    const daysToAnniversary = Math.ceil((anniversaryDateCopy - today) / (1000 * 60 * 60 * 24));

    // Display the number of days to the next anniversary
    daysToAnniversaryDiv.innerHTML = `<strong>Days to next Anniversary:</strong> ${daysToAnniversary}`;

    if (daysToAnniversary === 0 || (daysToAnniversary < 11 || daysToAnniversary > 355)) {
        showAnniversaryNotification(daysToAnniversary);
    }

    // Call showButtons with the calculated number of days
    showButtons(daysToAnniversary);
}

function showButtons(daysToAnniversary) {
    if (daysToAnniversary < 11 || daysToAnniversary > 355) {
        document.getElementById('wishAnniversaryButton').style.display = 'inline-block';
    } else {
        document.getElementById('wishAnniversaryButton').style.display = 'none';
    }
}

function handleKeyPress(event) {
    if (event.key === 'Enter') {
        getUserDetails();
    }
}

function showAnniversaryNotification(daysToAnniversary) {
    // Check if the browser supports notifications
    if ('Notification' in window && 'serviceWorker' in navigator && 'PushManager' in window) {
        Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
                const username = document.getElementById('username').value;
                const anniversaryURL = `${homewikiUrl}/w/index.php?title=User_talk:${username}&action=edit&section=new`;

                let notificationMessage = '';
                let notificationUrl = '';

                if (daysToAnniversary === 0) {
                    notificationMessage = `${username}'s anniversary is today! üéâ`;
                    notificationUrl = `${homewikiUrl}/w/index.php?title=User_talk:${username}&action=edit&section=new`;
                } else if (daysToAnniversary < 11) {
                    notificationMessage = `${username}'s anniversary is in ${daysToAnniversary} day${daysToAnniversary === 1 ? '' : 's'}! üéâ`;
                    notificationUrl = `${homewikiUrl}/w/index.php?title=User_talk:${username}&action=edit&section=new`;
                } else if (daysToAnniversary > 355) {
                    notificationMessage = `${username}'s anniversary was within the past 10 days! üéâ`;
                    notificationUrl = `${homewikiUrl}/w/index.php?title=User_talk:${username}&action=edit&section=new`;
                }

                const notificationOptions = {
                    body: notificationMessage,
                };

                const notification = new Notification('Anniversary Reminder', notificationOptions);

                // Add an event listener to handle the click on the notification
                notification.addEventListener('click', () => {
                    if (notificationUrl) {
                        window.open(notificationUrl, '_blank');
                    }
                });
            }
        });
    }
}
    
  setTimeout(function () {
  document.getElementById('usernameInput').style.display = 'block';
        }, 2000);
    
function handleInput(event) {
    const query = event.target.value.trim();
    const autocompleteList = document.getElementById('autocompleteList');
    
    if (query.length < 2) {
        autocompleteList.style.display = 'none';
        return;
    }

    // Using Wikimedia's API to search for users with more comprehensive data
    const apiUrl = `https://www.mediawiki.org/w/api.php?action=query&list=allusers&auprefix=${query}&aulimit=10&auprop=editcount|registration|groups|rights&format=json&origin=*`;

    // Also search in global users
    const globalApiUrl = `https://meta.wikimedia.org/w/api.php?action=query&list=globalallusers&aguprefix=${query}&agulimit=10&aguprop=editcount|registration|groups&format=json&origin=*`;

    Promise.all([
        fetch(apiUrl).then(response => response.json()),
        fetch(globalApiUrl).then(response => response.json())
    ])
    .then(([localData, globalData]) => {
        let users = [];
        
        // Combine local and global users
        if (localData.query && localData.query.allusers) {
            users = users.concat(localData.query.allusers.map(user => ({
                ...user,
                source: 'local'
            })));
        }
        
        if (globalData.query && globalData.query.globalallusers) {
            users = users.concat(globalData.query.globalallusers.map(user => ({
                ...user,
                source: 'global'
            })));
        }

        // Remove duplicates and sort by edit count
        users = Array.from(new Set(users.map(user => user.name)))
            .map(name => users.find(user => user.name === name))
            .sort((a, b) => (b.editcount || 0) - (a.editcount || 0));

        displayAutocompleteResults(users);
    })
    .catch(error => {
        console.error('Error:', error);
        autocompleteList.style.display = 'none';
    });
}

function displayAutocompleteResults(users) {
    const autocompleteList = document.getElementById('autocompleteList');
    const query = document.getElementById('username').value.trim();
    autocompleteList.innerHTML = '';

    if (users.length === 0) {
        autocompleteList.style.display = 'none';
        return;
    }

    users.forEach(user => {
        const item = document.createElement('div');
        item.className = 'autocomplete-item';
        
        // Create username element with highlighting
        const usernameDiv = document.createElement('div');
        usernameDiv.className = 'username';
        const username = user.name;
        const lowerUsername = username.toLowerCase();
        const lowerQuery = query.toLowerCase();
        const index = lowerUsername.indexOf(lowerQuery);
        
        if (index >= 0) {
            const before = username.slice(0, index);
            const match = username.slice(index, index + query.length);
            const after = username.slice(index + query.length);
            usernameDiv.innerHTML = `${before}<strong style="color: #2ecc71">${match}</strong>${after}`;
        } else {
            usernameDiv.textContent = username;
        }

        // Create details element with more user information
        const detailsDiv = document.createElement('div');
        detailsDiv.className = 'details';
        
        const editCount = user.editcount ? 
            `${user.editcount.toLocaleString()} edits` : 'No edits';
        
        const registrationDate = user.registration ? 
            new Date(user.registration).toLocaleDateString() : 'Unknown registration';
        
        const userGroups = user.groups ? 
            user.groups.slice(0, 3).join(', ') : '';
        
        const userSource = user.source === 'global' ? 'üåê' : 'üìù';

        detailsDiv.innerHTML = `
            <span>${userSource} ${editCount}</span>
            <span>üìÖ ${registrationDate}</span>
            ${userGroups ? `<span>üë• ${userGroups}</span>` : ''}
        `;

        item.appendChild(usernameDiv);
        item.appendChild(detailsDiv);
        
        item.onclick = () => {
            document.getElementById('username').value = user.name;
            autocompleteList.style.display = 'none';
            getUserDetails();
        };

        autocompleteList.appendChild(item);
    });

    autocompleteList.style.display = 'block';
}

function handleKeyDown(event) {
    const autocompleteList = document.getElementById('autocompleteList');
    const items = autocompleteList.getElementsByClassName('autocomplete-item');
    let selectedItem = autocompleteList.querySelector('.autocomplete-item.selected');
    let selectedIndex = Array.from(items).indexOf(selectedItem);

    if (items.length === 0) return;

    if (event.key === 'ArrowDown') {
        event.preventDefault();
        selectedIndex = (selectedIndex + 1) % items.length;
    } else if (event.key === 'ArrowUp') {
        event.preventDefault();
        selectedIndex = (selectedIndex - 1 + items.length) % items.length;
    } else if (event.key === 'Enter' && selectedItem) {
        event.preventDefault();
        selectedItem.click();
        return;
    } else {
        return;
    }

    Array.from(items).forEach((item, index) => {
        if (index === selectedIndex) {
            item.classList.add('selected');
            item.scrollIntoView({ block: 'nearest' });
        } else {
            item.classList.remove('selected');
        }
    });
}

// Close autocomplete list when clicking outside
document.addEventListener('click', function(event) {
    if (!event.target.matches('#username')) {
        document.getElementById('autocompleteList').style.display = 'none';
    }
});

// Add this new function after the displayUserDetails function
async function fetchRecentContributions(username) {
    try {
        const response = await fetch(`https://www.mediawiki.org/w/api.php?action=query&list=usercontribs&ucuser=${username}&uclimit=10&ucprop=title|timestamp|sizediff|comment&format=json&origin=*`);
        const data = await response.json();
        return data.query.usercontribs;
    } catch (error) {
        console.error('Error fetching contributions:', error);
        return [];
    }
}

// Add this new function to display the contributions
function displayRecentContributions(contributions) {
    const contributionsDiv = document.getElementById('recentContributions');
    const lang = document.getElementById('languageSelector').value;
    const texts = translations[lang];

    let html = `<h3>${texts.recentContributions}</h3>`;

    if (contributions.length === 0) {
        contributionsDiv.innerHTML = html + '<p style="text-align: center;">No recent contributions found.</p>';
        return;
    }

    html += '<div class="contributions-list">';
    contributions.forEach(contrib => {
        const timestamp = new Date(contrib.timestamp).toLocaleString();
        const sizeClass = contrib.sizediff > 0 ? 'size-positive' : 
                         contrib.sizediff < 0 ? 'size-negative' : 'size-neutral';
        const sizeLabel = contrib.sizediff > 0 ? `+${contrib.sizediff}` : contrib.sizediff;

        html += `
            <div class="contribution-item">
                <div class="contribution-title">
                    <a href="https://www.mediawiki.org/wiki/${encodeURIComponent(contrib.title)}" 
                       target="_blank">${contrib.title}</a>
                    <span class="contribution-size ${sizeClass}">${sizeLabel} bytes</span>
                </div>
                <div class="contribution-meta">
                    ${timestamp}
                    ${contrib.comment ? `<br>${contrib.comment}` : ''}
                </div>
            </div>
        `;
    });
    html += '</div>';

    contributionsDiv.innerHTML = html;
}

// Theme toggle functionality
function toggleTheme() {
    const html = document.documentElement;
    const themeToggle = document.getElementById('themeToggle');
    
    // Add transition class
    document.body.classList.add('theme-transition');
    
    if (html.getAttribute('data-theme') === 'dark') {
        html.removeAttribute('data-theme');
        themeToggle.textContent = 'üåô';
        localStorage.setItem('theme', 'light');
    } else {
        html.setAttribute('data-theme', 'dark');
        themeToggle.textContent = '‚òÄÔ∏è';
        localStorage.setItem('theme', 'dark');
    }
    
    // Remove transition class after animation completes
    setTimeout(() => {
        document.body.classList.remove('theme-transition');
    }, 500);
}

// Initialize theme from localStorage
function initializeTheme() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    const html = document.documentElement;
    const themeToggle = document.getElementById('themeToggle');
    
    if (savedTheme === 'dark') {
        html.setAttribute('data-theme', 'dark');
        themeToggle.textContent = '‚òÄÔ∏è';
    } else {
        html.removeAttribute('data-theme');
        themeToggle.textContent = 'üåô';
    }
}

// Call initializeTheme when the page loads
document.addEventListener('DOMContentLoaded', initializeTheme);

// Add this CSS for smooth transitions
const styleElement = document.createElement('style');
styleElement.textContent = `
    .theme-transition * {
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease !important;
    }
`;
document.head.appendChild(styleElement);
</script>

</body>
</html>